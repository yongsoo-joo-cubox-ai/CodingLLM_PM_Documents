# QA 기능 개선 보고서

| 항목 | 내용 |
|------|------|
| **문서번호** | SAI-TEST-2026-002 |
| **작성일** | 2026년 1월 28일 |
| **버전** | v2.0 |
| **보안등급** | 일반 |
| **작성** | Secern AI |

---

## 1. 배경 및 문제점

### 1.1 기존 시스템의 한계

기존 QA 시스템은 사용자 질문에 대해 지식베이스(API 문서)를 검색하고, LLM을 통해 답변을 생성하는 방식으로 동작했습니다. 그러나 다음과 같은 심각한 문제가 발견되었습니다:

#### 문제 1: 코드 예제 환각(Hallucination)

LLM이 지식베이스에 제공된 예제가 아닌, 자체적으로 "추론"한 코드 예제를 생성하는 현상이 발생했습니다.

| 구분 | 내용 |
|------|------|
| **질문** | "데이터셋에 행을 어떻게 추가하나요?" |
| **기대 답변** | `ds.addrow(); ds.setdatabyname('col', 'value');` |
| **실제 답변 (오류)** | `ds.addrow(); ds.setitemtext(0, 'col', 'value');` |

`setitemtext`는 Grid 컴포넌트의 API로, Dataset에서는 사용할 수 없습니다. 이러한 환각 현상은 개발자에게 잘못된 정보를 제공하여 디버깅 시간 낭비와 시스템 오류를 초래할 수 있습니다.

#### 문제 2: 동일 API명의 모호성

xFrame5에서는 동일한 이름의 API가 여러 컴포넌트에 존재합니다:

| API명 | 존재하는 컴포넌트 |
|-------|---------------|
| `addrow` | Grid, Dataset, TableView, MultilineGrid |
| `getrowcount` | Grid, Dataset, TreeGrid |
| `setdata` | Dataset, ComboBox |

"addrow 사용법"을 질문하면 시스템이 임의로 하나의 컴포넌트(예: TableView)를 선택하여 답변했으며, 이것이 사용자가 원하는 컴포넌트가 아닐 수 있었습니다.

---

## 2. 개선 방향 및 핵심 원칙

### 2.1 핵심 원칙 1: 추론하지 말고 추출하라

> **"LLM은 예제를 만들어내면 안 된다. 지식베이스에서 추출만 해야 한다."**

- 코드 예제는 반드시 API 문서에 명시된 `example` 필드에서 추출
- 문서에 예제가 없으면 예제 없이 답변 (빈 값 허용)
- LLM의 창작을 원천 차단하여 환각 현상 방지

### 2.2 핵심 원칙 2: 모호함은 사용자에게 확인하라

> **"시스템이 임의로 선택하지 말고, 사용자에게 물어봐라."**

- 동일 API가 여러 컴포넌트에 존재할 경우 → 사용자에게 선택지 제공
- 질문에 컴포넌트 맥락이 포함되면 → 해당 컴포넌트로 직접 답변

---

## 3. 개선 결과 및 사용 예시

### 3.1 예시 1: 모호한 질문 → 명확화 요청

**질문**: "addrow API 사용법을 알려주세요"

**개선 후 응답**:
```
상태: disambiguation (명확화 필요)

다음 중 어떤 컴포넌트의 addrow API에 대해 알려드릴까요?

• Grid - 그리드에 로우를 추가하는 API
• Dataset - 데이터셋에 한개의 빈 레코드를 추가
• TableView - 테이블뷰에 로우를 추가하는 API
• MultilineGrid - 멀티라인 그리드에 로우를 추가하는 API
```

### 3.2 예시 2: 맥락이 포함된 질문 → 직접 답변

**질문**: "데이터셋에 행을 어떻게 추가하나요?"

**개선 후 응답**:
```
데이터셋에 행을 추가하려면 addrow API를 사용합니다.
추가된 행에 데이터를 설정하려면 setdatabyname API를 사용해야 합니다.

[코드 예제]
ds_member.addrow();
ds_member.setdatabyname('name', 'John Doe');
ds_member.setdatabyname('age', '30');
```

올바른 Dataset API (`setdatabyname`) 사용, 문서에 명시된 예제 그대로 제공

### 3.3 개선 전후 비교

| 구분 | 개선 전 | 개선 후 |
|------|--------|--------|
| 코드 예제 | LLM이 추론하여 생성 | 문서에서 추출만 허용 |
| 동일 API명 | 임의 컴포넌트 선택 | 사용자에게 선택 요청 |
| 환각 현상 | 발생 가능 | 원천 차단 |
| 답변 신뢰도 | 낮음 | 높음 |

---

## 4. 기대 효과

1. **답변 신뢰성 향상**: 문서 기반 답변으로 환각 현상 제거
2. **개발 생산성 향상**: 잘못된 API 사용으로 인한 디버깅 시간 절감
3. **사용자 경험 개선**: 모호한 상황에서 명확한 선택지 제공
4. **유지보수 용이성**: API 문서 업데이트 시 자동으로 최신 예제 반영

---

## 5. 결론

이번 QA 기능 개선은 **"정확한 정보만 제공한다"**는 원칙을 기반으로 합니다. LLM의 강력한 언어 이해 능력은 활용하되, 코드 예제와 같이 정확성이 중요한 정보는 반드시 검증된 문서에서만 추출하도록 설계했습니다.

모호한 상황에서는 시스템이 임의로 판단하지 않고 사용자에게 확인을 요청함으로써, 사용자가 원하는 정확한 정보를 제공할 수 있게 되었습니다.

---

## 변경이력

| 버전 | 일자 | 변경 내용 | 작성자 |
|------|------|----------|--------|
| 1.0 | 2026-01-28 | 초판 작성 | 분석팀 |
| 2.0 | 2026-01-28 | 검증 강화, 소프트베이스 피드백 반영 | 분석팀 |
